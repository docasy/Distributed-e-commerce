# åˆ†å¸ƒå¼ç”µå•†å¹³å° ğŸ›’

<p align="center">
  <img src="https://img.shields.io/badge/Spring%20Boot-2.7.18-brightgreen.svg" alt="Spring Boot"/>
  <img src="https://img.shields.io/badge/Spring%20Cloud-2021.0.8-blue.svg" alt="Spring Cloud"/>
  <img src="https://img.shields.io/badge/Java-11-orange.svg" alt="Java"/>
  <img src="https://img.shields.io/badge/MySQL-8.0-blue.svg" alt="MySQL"/>
  <img src="https://img.shields.io/badge/Redis-7.0-red.svg" alt="Redis"/>
</p>

## ğŸ“– é¡¹ç›®ç®€ä»‹

è¿™æ˜¯ä¸€ä¸ªåŸºäº**å¾®æœåŠ¡æ¶æ„**çš„åˆ†å¸ƒå¼ç”µå•†å¹³å°åç«¯é¡¹ç›®ã€‚é¡¹ç›®æ¶µç›–äº†åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ ¸å¿ƒæŠ€æœ¯ç‚¹ï¼ŒåŒ…æ‹¬ï¼š

- âœ… **å¾®æœåŠ¡æ¶æ„**ï¼šç”¨æˆ·ã€å•†å“ã€è®¢å•æœåŠ¡ç‹¬ç«‹éƒ¨ç½²
- âœ… **åˆ†å¸ƒå¼é”**ï¼šRediså®ç°é˜²æ­¢å•†å“è¶…å–
- âœ… **æ¥å£å¹‚ç­‰æ€§**ï¼šTokenæœºåˆ¶é˜²æ­¢è®¢å•é‡å¤æäº¤
- âœ… **æ¶ˆæ¯é˜Ÿåˆ—**ï¼šRabbitMQå®ç°è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆ
- âœ… **æœåŠ¡è°ƒç”¨**ï¼šOpenFeignå®ç°æœåŠ¡é—´é€šä¿¡
- âœ… **ç½‘å…³é‰´æƒ**ï¼šSpring Cloud Gatewayç»Ÿä¸€JWTè®¤è¯
- âœ… **é™æµé™çº§**ï¼šGatewayé›†æˆRedisé™æµ
- âœ… **ç¼“å­˜ç­–ç•¥**ï¼šRedisç¼“å­˜çƒ­ç‚¹æ•°æ®

## ğŸ—ï¸ æŠ€æœ¯æ¶æ„

### æŠ€æœ¯æ ˆ

| æŠ€æœ¯ | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Spring Boot | 2.7.18 | åŸºç¡€æ¡†æ¶ |
| Spring Cloud | 2021.0.8 | å¾®æœåŠ¡æ¡†æ¶ |
| Spring Cloud Alibaba | 2021.0.5.0 | é˜¿é‡Œå·´å·´å¾®æœåŠ¡ç»„ä»¶ |
| Nacos | 2.2.3 | æœåŠ¡æ³¨å†Œä¸é…ç½®ä¸­å¿ƒ |
| Spring Cloud Gateway | - | APIç½‘å…³ |
| OpenFeign | - | æœåŠ¡è°ƒç”¨ |
| MyBatis Plus | 3.5.3.1 | ORMæ¡†æ¶ |
| MySQL | 8.0 | å…³ç³»å‹æ•°æ®åº“ |
| Redis | 7.0 | ç¼“å­˜æ•°æ®åº“ |
| RabbitMQ | 3.12 | æ¶ˆæ¯é˜Ÿåˆ— |
| Elasticsearch | 7.17 | æœç´¢å¼•æ“ï¼ˆå¯é€‰ï¼‰ |
| Docker | - | å®¹å™¨åŒ–éƒ¨ç½² |

### ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   å®¢æˆ·ç«¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜
       â”‚
       â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          API Gateway (8080)             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  è·¯ç”±    â”‚  é‰´æƒ    â”‚  é™æµ    â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
     â”‚            â”‚            â”‚
     â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·æœåŠ¡ â”‚  â”‚  å•†å“æœåŠ¡ â”‚  â”‚  è®¢å•æœåŠ¡ â”‚
â”‚  (8081)  â”‚  â”‚  (8082)  â”‚  â”‚  (8083)  â”‚
â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”˜
     â”‚            â”‚            â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                  â”‚
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â–¼            â–¼            â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  MySQL â”‚   â”‚  Redis â”‚   â”‚RabbitMQâ”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â””â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ é¡¹ç›®ç»“æ„

```
distributed-ecommerce/
â”œâ”€â”€ ecommerce-common/          # å…¬å…±æ¨¡å—
â”‚   â”œâ”€â”€ exception/            # ç»Ÿä¸€å¼‚å¸¸å¤„ç†
â”‚   â”œâ”€â”€ result/               # ç»Ÿä¸€å“åº”ç»“æœ
â”‚   â”œâ”€â”€ utils/                # å·¥å…·ç±»ï¼ˆJWTã€Redisé”ç­‰ï¼‰
â”‚   â””â”€â”€ constant/             # å¸¸é‡å®šä¹‰
â”œâ”€â”€ ecommerce-gateway/         # ç½‘å…³æœåŠ¡ (8080)
â”‚   â”œâ”€â”€ filter/               # é‰´æƒã€é™æµè¿‡æ»¤å™¨
â”‚   â””â”€â”€ config/               # ç½‘å…³é…ç½®
â”œâ”€â”€ ecommerce-user/            # ç”¨æˆ·æœåŠ¡ (8081)
â”‚   â”œâ”€â”€ controller/           # ç”¨æˆ·æ¥å£
â”‚   â”œâ”€â”€ service/              # ä¸šåŠ¡é€»è¾‘
â”‚   â”œâ”€â”€ mapper/               # æ•°æ®è®¿é—®
â”‚   â””â”€â”€ entity/               # å®ä½“ç±»
â”œâ”€â”€ ecommerce-product/         # å•†å“æœåŠ¡ (8082)
â”‚   â”œâ”€â”€ controller/           # å•†å“æ¥å£
â”‚   â”œâ”€â”€ service/              # åº“å­˜ç®¡ç†ã€ç¼“å­˜
â”‚   â””â”€â”€ mapper/               # æ•°æ®è®¿é—®
â”œâ”€â”€ ecommerce-order/           # è®¢å•æœåŠ¡ (8083)
â”‚   â”œâ”€â”€ controller/           # è®¢å•æ¥å£
â”‚   â”œâ”€â”€ service/              # è®¢å•åˆ›å»ºã€æ”¯ä»˜
â”‚   â”œâ”€â”€ feign/                # Feignè¿œç¨‹è°ƒç”¨
â”‚   â””â”€â”€ mq/                   # RabbitMQæ¶ˆæ¯å¤„ç†
â”œâ”€â”€ ecommerce-frontend/        # å‰ç«¯é¡¹ç›® (3000) ğŸ†•
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ api/              # APIæ¥å£å°è£…
â”‚   â”‚   â”œâ”€â”€ views/            # é¡µé¢ç»„ä»¶
â”‚   â”‚   â”œâ”€â”€ router/           # è·¯ç”±é…ç½®
â”‚   â”‚   â””â”€â”€ utils/            # å·¥å…·å‡½æ•°
â”‚   â”œâ”€â”€ package.json          # npmé…ç½®
â”‚   â””â”€â”€ vite.config.js        # Viteé…ç½®
â”œâ”€â”€ docker/                    # Dockeré…ç½®
â”‚   â””â”€â”€ mysql/init/           # æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ docker-compose.yml         # Dockerç¼–æ’æ–‡ä»¶
â””â”€â”€ pom.xml                    # Mavençˆ¶é¡¹ç›®
```

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ç¯å¢ƒè¦æ±‚

- JDK 11+
- Maven 3.6+
- Docker & Docker Compose

### 1. å¯åŠ¨åŸºç¡€æœåŠ¡

```bash
# å¯åŠ¨ MySQLã€Redisã€RabbitMQã€Elasticsearchã€Nacos
docker-compose up -d

# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps
```

### 2. è®¿é—®Nacosæ§åˆ¶å°

- åœ°å€ï¼šhttp://localhost:8848/nacos
- è´¦å·/å¯†ç ï¼šnacos/nacos

### 3. ç¼–è¯‘é¡¹ç›®

```bash
# æ ¹ç›®å½•æ‰§è¡Œ
mvn clean package -DskipTests
```

### 4. å¯åŠ¨å¾®æœåŠ¡

```bash
# æ–¹å¼1ï¼šIDEAä¸­ç›´æ¥è¿è¡Œå„ä¸ª Application ç±»

# æ–¹å¼2ï¼šå‘½ä»¤è¡Œå¯åŠ¨
cd ecommerce-user
mvn spring-boot:run

cd ecommerce-product
mvn spring-boot:run

cd ecommerce-order
mvn spring-boot:run

cd ecommerce-gateway
mvn spring-boot:run
```

### 5. å¯åŠ¨å‰ç«¯ï¼ˆå¯é€‰ï¼‰ğŸ†•

```bash
cd ecommerce-frontend

# å®‰è£…ä¾èµ–ï¼ˆé¦–æ¬¡è¿è¡Œï¼‰
npm install

# å¯åŠ¨å¼€å‘è®¿é—®æ–¹å¼

### æ–¹å¼1ï¼šå‰ç«¯ç•Œé¢è®¿é—® ğŸ†• æ¨è

è®¿é—®ï¼šhttp://localhost:3000

**æµ‹è¯•è´¦å·**ï¼š
- ç”¨æˆ·åï¼š`testuser`
- å¯†ç ï¼š`123456`

**åŠŸèƒ½é¡µé¢**ï¼š
- ğŸ” ç™»å½•/æ³¨å†Œ
- ğŸ›ï¸ å•†å“åˆ—è¡¨ï¼ˆæœç´¢ã€åˆ†é¡µï¼‰
- ğŸ“¦ å•†å“è¯¦æƒ…
- ğŸ›’ åˆ›å»ºè®¢å•
- ğŸ“‹ æˆ‘çš„è®¢å•ï¼ˆæŸ¥çœ‹ã€æ”¯ä»˜ã€å–æ¶ˆï¼‰

### æ–¹å¼2ï¼šPostmanæµ‹è¯•API

è¯¦è§ [QUICKSTART.md](QUICKSTART.md) ä¸­çš„å®Œæ•´æµ‹è¯•æµç¨‹ã€‚

**åŸºç¡€URL**

è®¿é—® http://localhost:8848/nacosï¼Œç¡®è®¤ä»¥ä¸‹æœåŠ¡å·²æ³¨å†Œï¼š
- âœ… ecommerce-user (8081)
- âœ… ecommerce-product (8082)
- âœ… ecommerce-order (8083)
- âœ… ecommerce-gateway (8080)
- âœ… ecommerce-frontend (3000) ğŸ†•

## ğŸ“ APIæ¥å£æ–‡æ¡£

è¯¦è§ [QUICKSTART.md](QUICKSTART.md) ä¸­çš„å®Œæ•´æµ‹è¯•æµç¨‹ã€‚

### åŸºç¡€URL

æ‰€æœ‰APIè¯·æ±‚é€šè¿‡ç½‘å…³è®¿é—®ï¼š`http://localhost:8080/api`

## ğŸ¯ æ ¸å¿ƒåŠŸèƒ½å®ç°

### 1. åˆ†å¸ƒå¼é”é˜²æ­¢è¶…å–

**ä½ç½®**ï¼š[ProductServiceImpl.java](ecommerce-product/src/main/java/com/ecommerce/product/service/impl/ProductServiceImpl.java)

```java
// è·å–åˆ†å¸ƒå¼é”
String lockValue = redisLockUtil.tryLockWithRetry(lockKey, 10, 3, 100);

// æ‰£å‡åº“å­˜
int result = productMapper.deductStock(productId, quantity);
```

### 2. æ¥å£å¹‚ç­‰æ€§è®¾è®¡

**ä½ç½®**ï¼š[OrderServiceImpl.java](ecommerce-order/src/main/java/com/ecommerce/order/service/impl/OrderServiceImpl.java)

```java
// Tokenæ ¡éªŒï¼ˆåªèƒ½ä½¿ç”¨ä¸€æ¬¡ï¼‰
Boolean deleted = redisTemplate.delete(tokenKey);
if (!Boolean.TRUE.equals(deleted)) {
    throw new BusinessException(ResultCode.DUPLICATE_REQUEST);
}
```

### 3. è®¢å•è¶…æ—¶è‡ªåŠ¨å–æ¶ˆ

**ä½ç½®**ï¼š[OrderMessageConsumer.java](ecommerce-order/src/main/java/com/ecommerce/order/mq/OrderMessageConsumer.java)

```java
// 30åˆ†é’Ÿåæ£€æŸ¥è®¢å•çŠ¶æ€
if (order.getStatus() == 0) {
    orderService.cancelOrder(orderNo);
}
```

### 4. JWTè®¤è¯

**ä½ç½®**ï¼š[AuthFilter.java](ecommerce-gateway/src/main/java/com/ecommerce/gateway/filter/AuthFilter.java)

```java
// éªŒè¯Token
boolean valid = JwtUtil.validateToken(token);
```

## ğŸ’¡ é¢è¯•è¦ç‚¹

è¯¦è§ [INTERVIEW.md](INTERVIEW.md) ä¸­çš„å®Œæ•´é¢è¯•å‡†å¤‡æŒ‡å—ã€‚

### é«˜é¢‘é—®é¢˜

1. **å¦‚ä½•é˜²æ­¢å•†å“è¶…å–ï¼Ÿ**
   - æ•°æ®åº“ä¹è§‚é” + Redisåˆ†å¸ƒå¼é”

2. **å¦‚ä½•ä¿è¯æ¥å£å¹‚ç­‰æ€§ï¼Ÿ**
   - Tokenæœºåˆ¶ + Redis

3. **åˆ†å¸ƒå¼äº‹åŠ¡å¦‚ä½•å¤„ç†ï¼Ÿ**
   - Seata ATæ¨¡å¼ + æ¶ˆæ¯é˜Ÿåˆ—è¡¥å¿

4. **å¦‚ä½•é˜²æ­¢ç¼“å­˜ç©¿é€/å‡»ç©¿/é›ªå´©ï¼Ÿ**
   - å¸ƒéš†è¿‡æ»¤å™¨ + äº’æ–¥é” + éšæœºè¿‡æœŸæ—¶é—´

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- âœ… Redisç¼“å­˜çƒ­ç‚¹å•†å“ï¼ˆ30åˆ†é’Ÿï¼‰
- âœ… MyBatis Plusæ‰¹é‡æŸ¥è¯¢
- âœ… æ•°æ®åº“è¿æ¥æ± ï¼ˆDruidï¼‰
- âœ… å¼‚æ­¥æ¶ˆæ¯å¤„ç†ï¼ˆRabbitMQï¼‰
- âœ… ç½‘å…³å±‚é™æµé™çº§

## ğŸ”§ å¾…æ‰©å±•åŠŸèƒ½

- [ ] Elasticsearchå•†å“æœç´¢
- [ ] Sentinelé™æµé™çº§
- [ ] Skywalkingé“¾è·¯è¿½è¸ª
- [ ] è´­ç‰©è½¦åŠŸèƒ½
- [ ] ä¼˜æƒ åˆ¸ç³»ç»Ÿ
- [ ] æ¨èç³»ç»Ÿ

## ğŸ“š å­¦ä¹ è·¯çº¿ï¼ˆ10å¤©è®¡åˆ’ï¼‰

| å¤©æ•° | ä»»åŠ¡ | é‡ç‚¹ |
|------|------|------|
| Day 1-2 | æ­å»ºåŸºç¡€æ¡†æ¶ | Spring Boot + MySQL + Redis |
| Day 3-4 | ç”¨æˆ·ã€å•†å“æœåŠ¡ | CRUD + ç¼“å­˜ |
| Day 5-6 | è®¢å•æœåŠ¡ | åˆ†å¸ƒå¼é” + å¹‚ç­‰æ€§ |
| Day 7-8 | ç½‘å…³ + æ¶ˆæ¯é˜Ÿåˆ— | JWTè®¤è¯ + RabbitMQ |
| Day 9 | Dockeréƒ¨ç½² | Docker Compose |
| Day 10 | å‹æµ‹ + æ–‡æ¡£ | JMeter + Swagger |

## ğŸ“„ ç›¸å…³æ–‡æ¡£

- ğŸ“˜ [å¿«é€Ÿå¼€å§‹æŒ‡å—](QUICKSTART.md) - 5åˆ†é’Ÿå¿«é€Ÿå¯åŠ¨é¡¹ç›®
- ğŸ“— [é¢è¯•å‡†å¤‡æŒ‡å—](INTERVIEW.md) - é«˜é¢‘é¢è¯•é—®é¢˜ & æ ‡å‡†ç­”æ¡ˆ
- ğŸ“™ [APIæ¥å£æ–‡æ¡£](QUICKSTART.md#æµ‹è¯•æ¥å£) - å®Œæ•´APIæµ‹è¯•æµç¨‹

## ğŸ¤ å¸¸è§é—®é¢˜

è¯¦è§ [QUICKSTART.md](QUICKSTART.md#å¸¸è§é—®é¢˜)

## ğŸ“ è”ç³»æ–¹å¼

å¦‚æœ‰é—®é¢˜ï¼Œæ¬¢è¿äº¤æµå­¦ä¹ ï¼

## ğŸ“„ è®¸å¯è¯

MIT License

---

â­ **å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™ä¸ªStaræ”¯æŒä¸€ä¸‹ï¼**